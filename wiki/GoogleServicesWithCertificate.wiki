#summary One-sentence summary of this page.
#labels Certificates,Featured

= Introduction =

This article briefly discusses what you need to do to:

  * Create a certificate using makecert.
  * Convert it to a pfx using pvk2pfx.
  * Upload the certificate you wish to use for your consumer.
  * Configure an OAuth session to use the certificate.

= Details =

Microsoft Visual Studio 2005 or later provides utilities (in the Common7\Tools\Bin directory) which can be used to generate a certificate for use with Google Apps. 

Follow the steps below to create the public and private key pair and certificate in .NET:

  # makecert -r -pe -n "CN=Test Certificate" -sky exchange -sv testcert.pvk testcert.cer
  # pvk2pfx -pvk testcert.pvk -spc testcert.cer -pfx testcert.pfx

By default the RSA algorithm is used in the commands above. Step 1 uses the Certificate Creation Tool (makecert.exe) to create a self signed X.509 certificate called testcert.cer and the corresponding private key. Step 2 uses the pvk2pfx Tool (pvk2pfx.exe) to create a Personal Information Exchange (PFX) file from a CER and PVK file. The PFX contains both your public and private key.

The testcert.cer can be uploaded to google via:

http://www.google.com/a/yourdomainname.com

Log in as an administrator. Select Advanced Tools, then Set up single sign-on (SSO), and fill in all the fields on the page.

Once done you are ready to start using the OAuth library with the various google services, you then just need to associate the certificate and RSA-SHA1 signature method with the session.

{{{
var certificate= new X509Certificate2("c:\\temp\\mycert.pfx");

var consumerContext = new OAuthConsumerContext
{
    ConsumerKey = "yourdomainname.com",
    SignatureMethod = SignatureMethod.RsaSha1,
    Key = certificate.PrivateKey
};
}}}